{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\nimport get from 'lodash/get';\nimport { useMemo } from 'react';\nimport { useGetManyAggregate } from '../../dataProvider';\nimport { useList } from '../list';\nimport { useNotify } from '../../notification';\nvar emptyArray = [];\nvar defaultFilter = {};\nvar defaultSort = {\n  field: null,\n  order: null\n};\n/**\n * Hook that fetches records from another resource specified\n * by an array of *ids* in current record.\n *\n * @example\n *\n * const { data, error, isFetching, isLoading } = useReferenceArrayFieldController({\n *      record: { referenceIds: ['id1', 'id2']};\n *      reference: 'reference';\n *      resource: 'resource';\n *      source: 'referenceIds';\n * });\n *\n * @param {Object} props\n * @param {Object} props.record The current resource record\n * @param {string} props.reference The linked resource name\n * @param {string} props.resource The current resource name\n * @param {string} props.source The key of the linked resource identifier\n *\n * @param {Props} props\n *\n * @returns {ListControllerResult} The reference props\n */\nexport var useReferenceArrayFieldController = function (props) {\n  var _a = props.filter,\n    filter = _a === void 0 ? defaultFilter : _a,\n    _b = props.page,\n    page = _b === void 0 ? 1 : _b,\n    _c = props.perPage,\n    perPage = _c === void 0 ? 1000 : _c,\n    record = props.record,\n    reference = props.reference,\n    _d = props.sort,\n    sort = _d === void 0 ? defaultSort : _d,\n    source = props.source,\n    _e = props.queryOptions,\n    queryOptions = _e === void 0 ? {} : _e;\n  var notify = useNotify();\n  var value = get(record, source);\n  var meta = queryOptions.meta,\n    otherQueryOptions = __rest(queryOptions, [\"meta\"]);\n  var ids = useMemo(function () {\n    if (Array.isArray(value)) return value;\n    console.warn(\"Value of field '\".concat(source, \"' is not an array.\"), value);\n    return emptyArray;\n  }, [value, source]);\n  var _f = useGetManyAggregate(reference, {\n      ids: ids,\n      meta: meta\n    }, __assign({\n      onError: function (error) {\n        return notify(typeof error === 'string' ? error : error.message || 'ra.notification.http_error', {\n          type: 'error',\n          messageArgs: {\n            _: typeof error === 'string' ? error : error && error.message ? error.message : undefined\n          }\n        });\n      }\n    }, otherQueryOptions)),\n    data = _f.data,\n    error = _f.error,\n    isLoading = _f.isLoading,\n    isFetching = _f.isFetching,\n    refetch = _f.refetch;\n  var listProps = useList({\n    data: data,\n    error: error,\n    filter: filter,\n    isFetching: isFetching,\n    isLoading: isLoading,\n    page: page,\n    perPage: perPage,\n    sort: sort\n  });\n  return __assign(__assign({}, listProps), {\n    defaultTitle: null,\n    refetch: refetch,\n    resource: reference\n  });\n};","map":{"version":3,"names":["get","useMemo","useGetManyAggregate","useList","useNotify","emptyArray","defaultFilter","defaultSort","field","order","useReferenceArrayFieldController","props","_a","filter","_b","page","_c","perPage","record","reference","_d","sort","source","_e","queryOptions","notify","value","meta","otherQueryOptions","__rest","ids","Array","isArray","console","warn","concat","_f","__assign","onError","error","message","type","messageArgs","_","undefined","data","isLoading","isFetching","refetch","listProps","defaultTitle","resource"],"sources":["/Users/robertbinning/Documents/GitHub/robertbinning/passkey/node_modules/ra-core/src/controller/field/useReferenceArrayFieldController.ts"],"sourcesContent":["import get from 'lodash/get';\nimport { useMemo } from 'react';\nimport { RaRecord, SortPayload } from '../../types';\nimport { useGetManyAggregate } from '../../dataProvider';\nimport { ListControllerResult, useList } from '../list';\nimport { useNotify } from '../../notification';\nimport { UseQueryOptions } from 'react-query';\n\nexport interface UseReferenceArrayFieldControllerParams<\n    RecordType extends RaRecord = RaRecord,\n    ReferenceRecordType extends RaRecord = RaRecord\n> {\n    filter?: any;\n    page?: number;\n    perPage?: number;\n    record?: RecordType;\n    reference: string;\n    resource: string;\n    sort?: SortPayload;\n    source: string;\n    queryOptions?: UseQueryOptions<ReferenceRecordType[], Error>;\n}\n\nconst emptyArray = [];\nconst defaultFilter = {};\nconst defaultSort = { field: null, order: null };\n\n/**\n * Hook that fetches records from another resource specified\n * by an array of *ids* in current record.\n *\n * @example\n *\n * const { data, error, isFetching, isLoading } = useReferenceArrayFieldController({\n *      record: { referenceIds: ['id1', 'id2']};\n *      reference: 'reference';\n *      resource: 'resource';\n *      source: 'referenceIds';\n * });\n *\n * @param {Object} props\n * @param {Object} props.record The current resource record\n * @param {string} props.reference The linked resource name\n * @param {string} props.resource The current resource name\n * @param {string} props.source The key of the linked resource identifier\n *\n * @param {Props} props\n *\n * @returns {ListControllerResult} The reference props\n */\nexport const useReferenceArrayFieldController = <\n    RecordType extends RaRecord = RaRecord,\n    ReferenceRecordType extends RaRecord = RaRecord\n>(\n    props: UseReferenceArrayFieldControllerParams<\n        RecordType,\n        ReferenceRecordType\n    >\n): ListControllerResult => {\n    const {\n        filter = defaultFilter,\n        page = 1,\n        perPage = 1000,\n        record,\n        reference,\n        sort = defaultSort,\n        source,\n        queryOptions = {},\n    } = props;\n    const notify = useNotify();\n    const value = get(record, source);\n    const { meta, ...otherQueryOptions } = queryOptions;\n\n    const ids = useMemo(() => {\n        if (Array.isArray(value)) return value;\n        console.warn(`Value of field '${source}' is not an array.`, value);\n        return emptyArray;\n    }, [value, source]);\n\n    const { data, error, isLoading, isFetching, refetch } = useGetManyAggregate<\n        ReferenceRecordType\n    >(\n        reference,\n        { ids, meta },\n        {\n            onError: error =>\n                notify(\n                    typeof error === 'string'\n                        ? error\n                        : error.message || 'ra.notification.http_error',\n                    {\n                        type: 'error',\n                        messageArgs: {\n                            _:\n                                typeof error === 'string'\n                                    ? error\n                                    : error && error.message\n                                    ? error.message\n                                    : undefined,\n                        },\n                    }\n                ),\n            ...otherQueryOptions,\n        }\n    );\n\n    const listProps = useList<ReferenceRecordType>({\n        data,\n        error,\n        filter,\n        isFetching,\n        isLoading,\n        page,\n        perPage,\n        sort,\n    });\n\n    return {\n        ...listProps,\n        defaultTitle: null,\n        refetch,\n        resource: reference,\n    };\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}